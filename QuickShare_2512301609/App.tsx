import React, { useState, useEffect, useRef } from 'react'; 
import { CapacitorAlarm } from '@capgo/capacitor-alarm'; import { LocalNotifications } from '@capacitor/local-notifications'; 
import FuturisticClock from './components/FuturisticClock'; 
import AlarmCard from './components/AlarmCard'; 
import { Alarm, ViewType, TimeFormat } from './types'; 
import { Plus, Bell, Timer as TimerIcon, Clock, X, Settings, Globe, Terminal, ShieldAlert, Zap, ZapOff } from 'lucide-react'; const App: React.FC = () => { const [alarms, setAlarms] = useState<Alarm[]>([]); const [activeView, setActiveView] = useState<ViewType>('Alarms'); const [isModalOpen, setIsModalOpen] = useState(false); const [isSettingsOpen, setIsSettingsOpen] = useState(false); const [timeFormat, setTimeFormat] = useState<TimeFormat>('24h'); const [triggeredAlarm, setTriggeredAlarm] = useState<Alarm | null>(null); const [newAlarm, setNewAlarm] = useState<Partial<Alarm>>({ time: '08:00', label: '', isActive: true, days: [1, 2, 3, 4, 5], isRepeating: true }); // Request native permissions on boot useEffect(() => { LocalNotifications.requestPermissions(); }, []); // Listen for Native Alarm Events useEffect(() => { const checkIncomingAlarm = async () => { // Logic to detect if app was opened by an alarm // This is handled by CapacitorAlarm.addListener in a production build }; checkIncomingAlarm(); }, []); const scheduleNativeAlarm = async (alarm: Alarm) => { const [hours, minutes] = alarm.time.split(':').map(Number); const date = new Date(); date.setHours(hours, minutes, 0, 0); if (date < new Date()) date.setDate(date.getDate() + 1); await CapacitorAlarm.set({ id: alarm.numericId, date: date.toISOString(), title: "YCLOCK OS BREACH", message: alarm.label || "System Entropy Critical", extra: { alarmId: alarm.id } }); }; const handleAddAlarm = () => { const id = Math.random().toString(36).substr(2, 9); const numericId = Math.floor(Math.random() * 1000000); const alarm: Alarm = { id, numericId, time: newAlarm.time || '08:00', label: newAlarm.label || 'Awakening Protocol', isActive: true, days: newAlarm.days || [], mood: 'Motivating', isRepeating: newAlarm.isRepeating ?? true }; setAlarms([...alarms, alarm]); scheduleNativeAlarm(alarm); setIsModalOpen(false); }; const terminateAlarm = async () => { if (triggeredAlarm) { await CapacitorAlarm.clear({ id: triggeredAlarm.numericId }); setTriggeredAlarm(null); } }; return ( <div className="h-screen bg-[#010409] text-zinc-100 flex flex-col font-rajdhani overflow-hidden relative"> {/* HEADER */} <header className="px-8 py-6 flex justify-between items-center border-b border-white/5 bg-[#010409]/60 backdrop-blur-3xl z-40"> <div className="flex items-center space-x-4"> <Terminal size={24} className="text-cyan-500" /> <span className="font-orbitron font-black text-2xl tracking-tighter">YCLOCK <span className="text-cyan-500">OS</span></span> </div> <button onClick={() => setIsSettingsOpen(true)} className="p-3 bg-white/5 rounded-2xl border border-white/10"><Settings size={20}/></button> </header> {/* MAIN CONTENT */} <main className="flex-grow flex flex-col items-center py-10 px-6 overflow-y-auto no-scrollbar pb-32"> <FuturisticClock format={timeFormat} /> <button onClick={() => setIsModalOpen(true)} className="mt-10 px-10 py-4 bg-cyan-500 text-black font-black rounded-2xl shadow-[0_0_30px_rgba(6,182,212,0.4)] uppercase tracking-widest text-xs" > Sync Node </button> <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-12 w-full max-w-4xl"> {alarms.map(a => ( <div key={a.id} className="p-6 bg-white/5 border border-white/10 rounded-3xl flex justify-between items-center"> <div> <p className="text-3xl font-black font-orbitron">{a.time}</p> <p className="text-[10px] text-zinc-500 tracking-widest uppercase">{a.label}</p> </div> <div className={w-12 h-6 rounded-full transition-all ${a.isActive ? 'bg-cyan-500' : 'bg-zinc-800'}}></div> </div> ))} </div> </main> {/* DISMISS / TERMINATE SCREEN (SAME UI AS REQUESTED) */} {triggeredAlarm && ( <div className="fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center p-10"> <div className="absolute inset-0 bg-[#4c0519] opacity-30 animate-pulse"></div> <div className="relative z-10 flex flex-col items-center text-center space-y-12 w-full"> <div className="w-32 h-32 rounded-full bg-magenta-500/20 flex items-center justify-center border-2 border-magenta-500/50 animate-bounce shadow-[0_0_50px_rgba(217,70,239,0.5)]"> <ShieldAlert size={64} className="text-magenta-400" /> </div> <h1 className="text-5xl font-black font-orbitron text-white glow-magenta">CRITICAL BREACH</h1> <p className="text-magenta-500 font-black tracking-[0.8em] uppercase">Time: {triggeredAlarm.time}</p> <div className="grid grid-cols-1 sm:grid-cols-2 gap-6 w-full max-w-2xl"> <button className="py-8 bg-cyan-500/10 border-2 border-cyan-500 text-cyan-400 font-black font-orbitron rounded-[2rem] text-xl">ZOON (SNOOZE)</button> <button onClick={terminateAlarm} className="py-8 bg-white text-black font-black font-orbitron rounded-[2rem] text-xl shadow-[0_0_60px_rgba(255,255,255,0.4)]">TERMINATE</button> </div> </div> </div> )} </div> ); }; export default App;